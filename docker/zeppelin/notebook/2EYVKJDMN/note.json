{
  "paragraphs": [
    {
      "text": "%pyspark\nimport numpy as np\n\nN\u003d500\ndata\u003dnp.random.uniform(0,1,N)\nprint(data)\n\nN2\u003d50\nbins\u003d np.arange(0,1,1./N2)\nprint(bins)\n    ",
      "user": "anonymous",
      "dateUpdated": "Feb 2, 2020 8:47:59 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[ 0.11840519  0.83386865  0.86355951  0.70819265  0.67535875  0.28558158\n  0.05635725  0.68045273  0.16063915  0.38029925  0.9110374   0.87994559\n  0.07567718  0.97692372  0.54082467  0.67101567  0.34954283  0.48956928\n  0.0926382   0.03081287  0.15870155  0.95826512  0.32397816  0.04290046\n  0.3541444   0.83648242  0.64011877  0.26375762  0.88176736  0.90995342\n  0.48875882  0.02682183  0.40761519  0.15936035  0.06920642  0.06359303\n  0.17289519  0.10979279  0.81320011  0.25899125  0.80095374  0.51649957\n  0.60421977  0.17279952  0.54614448  0.26026492  0.50182318  0.37616508\n  0.00583809  0.16897978  0.65584323  0.05677491  0.71067469  0.89430889\n  0.25144059  0.12540895  0.71933598  0.39154508  0.17321973  0.393102\n  0.6511479   0.74283186  0.56572683  0.42739313  0.83435664  0.49443035\n  0.11498017  0.08223448  0.11056051  0.25737869  0.13246236  0.01571841\n  0.36747466  0.51470954  0.45290156  0.67508686  0.66269965  0.85480095\n  0.65004235  0.75277953  0.36723699  0.29899875  0.15729493  0.01650082\n  0.26180199  0.04838504  0.48624204  0.97887173  0.78592586  0.15460901\n  0.05876063  0.08415158  0.82534979  0.90045921  0.2221059   0.42529473\n  0.47982533  0.46577025  0.6302827   0.27532217  0.33235819  0.58500417\n  0.97053218  0.10808539  0.14741984  0.3035157   0.24562349  0.92251587\n  0.01263042  0.93155193  0.11909304  0.60922932  0.89406305  0.24739923\n  0.24300466  0.34314519  0.13783032  0.62098896  0.20112722  0.09423761\n  0.24035187  0.54340078  0.24237878  0.37469657  0.48007038  0.19946616\n  0.8099789   0.38577392  0.51747063  0.82955685  0.02183131  0.12996447\n  0.58832367  0.98097253  0.39835149  0.68618586  0.48717313  0.61500656\n  0.8008397   0.78837923  0.67169783  0.62963559  0.77384734  0.19431762\n  0.25354621  0.72263973  0.31538058  0.62998282  0.9576305   0.67471235\n  0.780934    0.82172257  0.36949077  0.95372951  0.6495474   0.0253411\n  0.4157317   0.43018876  0.28968125  0.81388744  0.32155434  0.20095981\n  0.8242282   0.71354559  0.15285641  0.56725206  0.66074548  0.84094301\n  0.04302451  0.69944938  0.74519072  0.06177162  0.30377018  0.46111955\n  0.12565699  0.73784614  0.4879483   0.84719553  0.15076543  0.81014262\n  0.49642912  0.43111581  0.42356376  0.086489    0.90731525  0.3913244\n  0.87997241  0.95378103  0.55564815  0.52858334  0.7429557   0.10635913\n  0.50621402  0.57853452  0.3653768   0.82807002  0.97515034  0.098266\n  0.84051847  0.3083715   0.74051448  0.91523708  0.77113399  0.78851303\n  0.43699339  0.95188331  0.7245135   0.68239701  0.99718599  0.06416868\n  0.70425934  0.42187491  0.24643991  0.08948073  0.59097429  0.1880356\n  0.98268012  0.08383792  0.4217413   0.28986997  0.04821485  0.43974327\n  0.40049319  0.41339148  0.59369601  0.33267714  0.72949507  0.31186015\n  0.09193904  0.00957902  0.55840621  0.83012523  0.62392855  0.81401088\n  0.01013157  0.957039    0.82070112  0.21675318  0.1656903   0.53944274\n  0.00627503  0.54092754  0.75074288  0.9999621   0.77260742  0.71235264\n  0.15767043  0.70383016  0.01390679  0.04573507  0.24507734  0.3496374\n  0.51783748  0.93282842  0.45388016  0.73370536  0.44247571  0.55423166\n  0.06313662  0.01360929  0.63649775  0.46231511  0.49242141  0.35887538\n  0.80922762  0.07110497  0.26678903  0.9002161   0.76039416  0.40897996\n  0.00889065  0.68796256  0.01581884  0.88840756  0.43961066  0.83966975\n  0.60867698  0.46633442  0.18201116  0.51393724  0.32255958  0.60749309\n  0.89081366  0.10869191  0.34512358  0.7880848   0.96077624  0.80241436\n  0.1591056   0.93653888  0.95909507  0.47944505  0.18970633  0.6140423\n  0.47704373  0.98714617  0.26875565  0.7468795   0.99116185  0.5899181\n  0.94174227  0.94223903  0.01696038  0.87599876  0.16879329  0.96201624\n  0.27756545  0.37769553  0.58370213  0.56121725  0.66958865  0.69186113\n  0.35458448  0.55797794  0.54802819  0.67422988  0.74861217  0.29359114\n  0.66279532  0.66512692  0.49141663  0.26712773  0.34734076  0.58089334\n  0.06487568  0.93486574  0.276689    0.19902635  0.11345735  0.05510101\n  0.77369249  0.72613141  0.97043135  0.62347167  0.41778933  0.46145188\n  0.54341858  0.55267711  0.96685811  0.50057103  0.67264516  0.18215461\n  0.09012464  0.5340535   0.06630103  0.20531882  0.4561704   0.71871991\n  0.132923    0.95619521  0.10595037  0.35861539  0.76795625  0.46056974\n  0.59197736  0.13308114  0.88756882  0.2523863   0.14416041  0.23097544\n  0.78905307  0.44837411  0.22952363  0.94230095  0.83048963  0.2609421\n  0.64957918  0.34710633  0.60117641  0.40910186  0.65928513  0.5803923\n  0.77603119  0.97501823  0.46112842  0.70393796  0.13756166  0.85352324\n  0.00750372  0.69623261  0.60697937  0.50947608  0.96408796  0.42057204\n  0.84597442  0.5811799   0.29379716  0.67230575  0.44845728  0.48275216\n  0.63977598  0.787398    0.37276874  0.93823356  0.81423601  0.10387362\n  0.70862585  0.06865841  0.31075981  0.21087597  0.05130669  0.23539161\n  0.36077605  0.96882267  0.79719551  0.27481488  0.86571492  0.09265127\n  0.67262313  0.28183399  0.32300403  0.25763674  0.67583403  0.28780836\n  0.89568263  0.98172129  0.29962674  0.70527174  0.90268113  0.73664569\n  0.44481892  0.84673089  0.05622237  0.08828459  0.29645335  0.03890311\n  0.41514993  0.63036812  0.82728073  0.51666765  0.5439997   0.96641065\n  0.53552592  0.06314827  0.94086832  0.6890602   0.92553571  0.77924287\n  0.20901584  0.90251612  0.87049407  0.55111482  0.86554159  0.11697072\n  0.47282636  0.72623032  0.45988533  0.13327604  0.62768863  0.92830094\n  0.16927481  0.91764577  0.77557169  0.65437234  0.53633687  0.87023138\n  0.28736857  0.83962992  0.23411562  0.40551998  0.76213108  0.7550162\n  0.85433105  0.76435981  0.92801449  0.73567288  0.17576928  0.63942889\n  0.81024095  0.57642846  0.69158088  0.61665895  0.6868055   0.83806134\n  0.49811037  0.05958219  0.7825957   0.57216511  0.61528687  0.22816705\n  0.02059374  0.82037283  0.03189471  0.17205803  0.50496059  0.98192312\n  0.90251288  0.87879803  0.66355533  0.79221816  0.67743689  0.74385493\n  0.7245289   0.45431418  0.3468583   0.33872401  0.29891558  0.18786174\n  0.72811349  0.16568963]\n[ 0.    0.02  0.04  0.06  0.08  0.1   0.12  0.14  0.16  0.18  0.2   0.22\n  0.24  0.26  0.28  0.3   0.32  0.34  0.36  0.38  0.4   0.42  0.44  0.46\n  0.48  0.5   0.52  0.54  0.56  0.58  0.6   0.62  0.64  0.66  0.68  0.7\n  0.72  0.74  0.76  0.78  0.8   0.82  0.84  0.86  0.88  0.9   0.92  0.94\n  0.96  0.98]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1580632271126_1960005419",
      "id": "20200202-083111_1077009015",
      "dateCreated": "Feb 2, 2020 8:31:11 AM",
      "dateStarted": "Feb 2, 2020 8:47:59 AM",
      "dateFinished": "Feb 2, 2020 8:47:59 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndef cartesian(x,y):\n    np.transpose([np.tile(x, len(y)), np.repeat(y, len(x))])",
      "user": "anonymous",
      "dateUpdated": "Feb 2, 2020 8:41:07 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1580632290340_227496446",
      "id": "20200202-083130_206812215",
      "dateCreated": "Feb 2, 2020 8:31:30 AM",
      "dateStarted": "Feb 2, 2020 8:41:07 AM",
      "dateFinished": "Feb 2, 2020 8:41:07 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nprint( cartesian(data,binning) )",
      "user": "anonymous",
      "dateUpdated": "Feb 2, 2020 8:41:14 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "None\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1580632830083_-1179564219",
      "id": "20200202-084030_539041740",
      "dateCreated": "Feb 2, 2020 8:40:30 AM",
      "dateStarted": "Feb 2, 2020 8:41:14 AM",
      "dateFinished": "Feb 2, 2020 8:41:14 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\ndef simple_binning(y,x):\n    cartesian(x,y)\n    \ndef linear_binnning(x,y):",
      "user": "anonymous",
      "dateUpdated": "Feb 2, 2020 8:40:30 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1580632825788_-2038339088",
      "id": "20200202-084025_576340379",
      "dateCreated": "Feb 2, 2020 8:40:25 AM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\ndigitized \u003d np.digitize(data, bins)\nprint(digitized)\nbin_means \u003d [data[digitized \u003d\u003d i].mean() for i in range(1, len(bins))]\nprint(bin_means)\nprint(sum(bin_means))\n\n#An alternative to this is to use np.histogram():\n\nbin_means \u003d (np.histogram(data, bins, weights\u003ddata)[0], np.histogram(data, bins)[0])\nprint(bin_means)\n             ",
      "user": "anonymous",
      "dateUpdated": "Feb 2, 2020 8:48:01 AM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala"
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[ 6 42 44 36 34 15  3 35  9 20 46 44  4 49 28 34 18 25  5  2  8 48 17  3 18\n 42 33 14 45 46 25  2 21  8  4  4  9  6 41 13 41 26 31  9 28 14 26 19  1  9\n 33  3 36 45 13  7 36 20  9 20 33 38 29 22 42 25  6  5  6 13  7  1 19 26 23\n 34 34 43 33 38 19 15  8  1 14  3 25 49 40  8  3  5 42 46 12 22 24 24 32 14\n 17 30 49  6  8 16 13 47  1 47  6 31 45 13 13 18  7 32 11  5 13 28 13 19 25\n 10 41 20 26 42  2  7 30 50 20 35 25 31 41 40 34 32 39 10 13 37 16 32 48 34\n 40 42 19 48 33  2 21 22 15 41 17 11 42 36  8 29 34 43  3 35 38  4 16 24  7\n 37 25 43  8 41 25 22 22  5 46 20 44 48 28 27 38  6 26 29 19 42 49  5 43 16\n 38 46 39 40 22 48 37 35 50  4 36 22 13  5 30 10 50  5 22 15  3 22 21 21 30\n 17 37 16  5  1 28 42 32 41  1 48 42 11  9 27  1 28 38 50 39 36  8 36  1  3\n 13 18 26 47 23 37 23 28  4  1 32 24 25 18 41  4 14 46 39 21  1 35  1 45 22\n 42 31 24 10 26 17 31 45  6 18 40 49 41  8 47 48 24 10 31 24 50 14 38 50 30\n 48 48  1 44  9 49 14 19 30 29 34 35 18 28 28 34 38 15 34 34 25 14 18 30  4\n 47 14 10  6  3 39 37 49 32 21 24 28 28 49 26 34 10  5 27  4 11 23 36  7 48\n  6 18 39 24 30  7 45 13  8 12 40 23 12 48 42 14 33 18 31 21 33 30 39 49 24\n 36  7 43  1 35 31 26 49 22 43 30 15 34 23 25 32 40 19 47 41  6 36  4 16 11\n  3 12 19 49 40 14 44  5 34 15 17 13 34 15 45 50 15 36 46 37 23 43  3  5 15\n  2 21 32 42 26 28 49 27  4 48 35 47 39 11 46 44 28 44  6 24 37 23  7 32 47\n  9 46 39 33 27 44 15 42 12 21 39 38 43 39 47 37  9 32 41 29 35 31 35 42 25\n  3 40 29 31 12  2 42  2  9 26 50 46 44 34 40 34 38 37 23 18 17 15 10 37  9]\n[0.011797155727197989, 0.028028382981476203, 0.051863748015964224, 0.066512899883049204, 0.089527921613343595, 0.11135168358227938, 0.13201832618082121, 0.1541943967271889, 0.16961897368870729, 0.19032244748962618, 0.20734180543505429, 0.23004654172906203, 0.24935808007165922, 0.26853004993182172, 0.29196053648071685, 0.3089429880218757, 0.32783649258409897, 0.35045218569724529, 0.37018679968290202, 0.3900660250314163, 0.41041918124756283, 0.4289174333721037, 0.45125307253166358, 0.46798453116338801, 0.48961016706321225, 0.51092427235527749, 0.534788475693459, 0.54898460305261265, 0.57022070432704997, 0.5866061258784111, 0.6098769611874626, 0.63018633308070582, 0.65124203954585069, 0.67043868569978748, 0.6891987867476399, 0.7098860463745944, 0.72959295412833225, 0.74693779740739819, 0.77063348221600736, 0.78802973673274479, 0.80901202930529159, 0.82999785563750628, 0.84800219465917781, 0.87225069558646018, 0.89037313878813784, 0.90695743671659734, 0.9309317253075462, 0.95123077678211121, 0.96965828462167369]\n24.0041029678\n(array([  0.15336302,   0.19619868,   0.62236498,   0.7316419 ,\n         1.07433506,   1.3362202 ,   1.18816494,   1.54194397,\n         1.86580871,   1.52257958,   1.24405083,   1.38027925,\n         3.24165504,   2.95383055,   3.50352644,   1.85365793,\n         2.29485545,   3.85497404,   3.3316812 ,   2.34039615,\n         3.69377263,   4.71809177,   4.06127765,   5.14782984,\n         5.875322  ,   5.620167  ,   2.67394238,   7.13679984,\n         3.42132423,   5.86606126,   6.09876961,   6.93204966,\n         5.20993632,  11.39745766,   6.89198787,   7.80874651,\n         8.0255225 ,   7.46937797,   8.4769683 ,   7.88029737,\n         8.89913232,  13.27996569,   6.78401756,   7.85025626,\n         6.23261197,   9.06957437,   8.37838553,  11.41476932,  11.63589942]), array([13,  7, 12, 11, 12, 12,  9, 10, 11,  8,  6,  6, 13, 11, 12,  6,  7,\n       11,  9,  6,  9, 11,  9, 11, 12, 11,  5, 13,  6, 10, 10, 11,  8, 17,\n       10, 11, 11, 10, 11, 10, 11, 16,  8,  9,  7, 10,  9, 12, 12]))\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1580633104631_31267405",
      "id": "20200202-084504_1383688841",
      "dateCreated": "Feb 2, 2020 8:45:04 AM",
      "dateStarted": "Feb 2, 2020 8:48:01 AM",
      "dateFinished": "Feb 2, 2020 8:48:02 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "Feb 2, 2020 8:45:26 AM",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1580633126167_-709358903",
      "id": "20200202-084526_472764520",
      "dateCreated": "Feb 2, 2020 8:45:26 AM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Binning Example",
  "id": "2EYVKJDMN",
  "angularObjects": {
    "2F1KFPZ8U:shared_process": [],
    "2EYCXZC8P:shared_process": [],
    "2EZED46C8:shared_process": [],
    "2F2RZVEFT:shared_process": [],
    "2EY5SVCBR:shared_process": [],
    "2F239U6UJ:shared_process": [],
    "2F2R9PWSA:shared_process": [],
    "2EYNB5MG3:shared_process": [],
    "2F1M8NQQ5:shared_process": [],
    "2EYA3TTMM:shared_process": [],
    "2EYHFDD55:shared_process": [],
    "2F1FYTVWW:shared_process": [],
    "2F26CKDA2:shared_process": [],
    "2EZBDRR55:shared_process": [],
    "2F2QH61MQ:shared_process": [],
    "2F2CPNT1V:shared_process": [],
    "2EZQ5J62A:shared_process": [],
    "2F2C83QZ5:shared_process": [],
    "2EZ9DEQMZ:shared_process": []
  },
  "config": {},
  "info": {}
}